"use strict";var age=(()=>{var St=Object.defineProperty;var kn=Object.getOwnPropertyDescriptor;var On=Object.getOwnPropertyNames,Le=Object.getOwnPropertySymbols;var _e=Object.prototype.hasOwnProperty,Nn=Object.prototype.propertyIsEnumerable;var rt=Math.pow,Ue=(e,t,n)=>t in e?St(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Wt=(e,t)=>{for(var n in t||(t={}))_e.call(t,n)&&Ue(e,n,t[n]);if(Le)for(var n of Le(t))Nn.call(t,n)&&Ue(e,n,t[n]);return e};var Rn=(e,t)=>{for(var n in t)St(e,n,{get:t[n],enumerable:!0})},Mn=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of On(t))!_e.call(e,s)&&s!==n&&St(e,s,{get:()=>t[s],enumerable:!(r=kn(t,s))||r.enumerable});return e};var Hn=e=>Mn(St({},"__esModule",{value:!0}),e);var Cr={};Rn(Cr,{Decrypter:()=>ve,Encrypter:()=>Ae,generateIdentity:()=>_r,identityToRecipient:()=>Sr});function Te(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ke(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function qn(e){if(typeof e!="function")throw new Error("function expected");return!0}function At(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Oe(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function Ft(e){if(!Array.isArray(e))throw new Error("array expected")}function Ne(e,t){if(!ke(!0,t))throw new Error(`${e}: array of strings expected`)}function Re(e,t){if(!ke(!1,t))throw new Error(`${e}: array of numbers expected`)}function Me(...e){let t=o=>o,n=(o,i)=>c=>o(i(c)),r=e.map(o=>o.encode).reduceRight(n,t),s=e.map(o=>o.decode).reduce(n,t);return{encode:r,decode:s}}function He(e){let t=typeof e=="string"?e.split(""):e,n=t.length;Ne("alphabet",t);let r=new Map(t.map((s,o)=>[s,o]));return{encode:s=>(Ft(s),s.map(o=>{if(!Number.isSafeInteger(o)||o<0||o>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${o}". Allowed: ${e}`);return t[o]})),decode:s=>(Ft(s),s.map(o=>{At("alphabet.decode",o);let i=r.get(o);if(i===void 0)throw new Error(`Unknown letter: "${o}". Allowed: ${e}`);return i}))}}function qe(e=""){return At("join",e),{encode:t=>(Ne("join.decode",t),t.join(e)),decode:t=>(At("join.decode",t),t.split(e))}}var Ke=(e,t)=>t===0?e:Ke(t,e%t),Ct=(e,t)=>e+(t-Ke(e,t)),It=(()=>{let e=[];for(let t=0;t<40;t++)e.push(rt(2,t));return e})();function $t(e,t,n,r){if(Ft(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Ct(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Ct(t,n)}`);let s=0,o=0,i=It[t],c=It[n]-1,f=[];for(let a of e){if(Oe(a),a>=i)throw new Error(`convertRadix2: invalid data word=${a} from=${t}`);if(s=s<<t|a,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=n;o-=n)f.push((s>>o-n&c)>>>0);let l=It[o];if(l===void 0)throw new Error("invalid carry");s&=l-1}if(s=s<<n-o&c,!r&&o>=t)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&o>0&&f.push(s>>>0),f}function Pe(e,t=!1){if(Oe(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Ct(8,e)>32||Ct(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!Te(n))throw new Error("radix2.encode input should be Uint8Array");return $t(Array.from(n),8,e,!t)},decode:n=>(Re("radix2.decode",n),Uint8Array.from($t(n,e,8,t)))}}function Se(e){return qn(e),function(...t){try{return e.apply(null,t)}catch(n){}}}var X=Me(Pe(6),He("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),qe(""));var Gt=Me(He("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),qe("")),Ie=[996825010,642813549,513874426,1027748829,705979059];function Bt(e){let t=e>>25,n=(e&33554431)<<5;for(let r=0;r<Ie.length;r++)(t>>r&1)===1&&(n^=Ie[r]);return n}function Ce(e,t,n=1){let r=e.length,s=1;for(let o=0;o<r;o++){let i=e.charCodeAt(o);if(i<33||i>126)throw new Error(`Invalid prefix (${e})`);s=Bt(s)^i>>5}s=Bt(s);for(let o=0;o<r;o++)s=Bt(s)^e.charCodeAt(o)&31;for(let o of t)s=Bt(s)^o;for(let o=0;o<6;o++)s=Bt(s);return s^=n,Gt.encode($t([s%It[30]],30,5,!1))}function Kn(e){let t=e==="bech32"?1:734539939,n=Pe(5),r=n.decode,s=n.encode,o=Se(r);function i(u,h,y=90){At("bech32.encode prefix",u),Te(h)&&(h=Array.from(h)),Re("bech32.encode",h);let p=u.length;if(p===0)throw new TypeError(`Invalid prefix length ${p}`);let d=p+7+h.length;if(y!==!1&&d>y)throw new TypeError(`Length ${d} exceeds limit ${y}`);let w=u.toLowerCase(),m=Ce(w,h,t);return`${w}1${Gt.encode(h)}${m}`}function c(u,h=90){At("bech32.decode input",u);let y=u.length;if(y<8||h!==!1&&y>h)throw new TypeError(`invalid string length: ${y} (${u}). Expected (8..${h})`);let p=u.toLowerCase();if(u!==p&&u!==u.toUpperCase())throw new Error("String must be lowercase or uppercase");let d=p.lastIndexOf("1");if(d===0||d===-1)throw new Error('Letter "1" must be present between prefix and data only');let w=p.slice(0,d),m=p.slice(d+1);if(m.length<6)throw new Error("Data must be at least 6 characters long");let b=Gt.decode(m).slice(0,-6),E=Ce(w,b,t);if(!m.endsWith(E))throw new Error(`Invalid checksum in ${u}: expected "${E}"`);return{prefix:w,words:b}}let f=Se(c);function a(u){let{prefix:h,words:y}=c(u,!1);return{prefix:h,words:y,bytes:r(y)}}function l(u,h){return i(u,s(h))}return{encode:i,decode:c,encodeFromBytes:l,decodeToBytes:a,decodeUnsafe:f,fromWords:r,fromWordsUnsafe:o,toWords:s}}var ot=Kn("bech32");function j(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Pn(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function vt(e,...t){if(!Pn(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function at(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");j(e.outputLen),j(e.blockLen)}function yt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function De(e,t){vt(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}var ut=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Tt=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),gt=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),$=(e,t)=>e<<32-t|e>>>t,R=(e,t)=>e<<t|e>>>32-t>>>0,Yt=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,Dn=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;function Zt(e){for(let t=0;t<e.length;t++)e[t]=Dn(e[t])}function Ve(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function G(e){return typeof e=="string"&&(e=Ve(e)),vt(e),e}var xt=class{clone(){return this._cloneInto()}};function kt(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function je(e){let t=r=>e().update(G(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Q(e=32){if(ut&&typeof ut.getRandomValues=="function")return ut.getRandomValues(new Uint8Array(e));if(ut&&typeof ut.randomBytes=="function")return ut.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}var Ot=class extends xt{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,at(t);let r=G(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let s=this.blockLen,o=new Uint8Array(s);o.set(r.length>s?t.create().update(r).digest():r);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=t.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),o.fill(0)}update(t){return yt(this),this.iHash.update(t),this}digestInto(t){yt(this),vt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:s,destroyed:o,blockLen:i,outputLen:c}=this;return t=t,t.finished=s,t.destroyed=o,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},J=(e,t,n)=>new Ot(e,t).update(n).digest();J.create=(e,t)=>new Ot(e,t);function Vn(e,t,n){return at(e),n===void 0&&(n=new Uint8Array(e.outputLen)),J(e,G(n),G(t))}var Qt=new Uint8Array([0]),ze=new Uint8Array;function jn(e,t,n,r=32){if(at(e),j(r),r>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");let s=Math.ceil(r/e.outputLen);n===void 0&&(n=ze);let o=new Uint8Array(s*e.outputLen),i=J.create(e,t),c=i._cloneInto(),f=new Uint8Array(i.outputLen);for(let a=0;a<s;a++)Qt[0]=a+1,c.update(a===0?ze:f).update(n).update(Qt).digestInto(f),o.set(f,e.outputLen*a),i._cloneInto(c);return i.destroy(),c.destroy(),f.fill(0),Qt.fill(0),o.slice(0,r)}var st=(e,t,n,r,s)=>jn(e,Vn(e,t,n),r,s);function zn(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),c=Number(n&o),f=r?4:0,a=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+a,c,r)}var We=(e,t,n)=>e&t^~e&n,Fe=(e,t,n)=>e&t^e&n^t&n,Nt=class extends xt{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=gt(this.buffer)}update(t){yt(this);let{view:n,buffer:r,blockLen:s}=this;t=G(t);let o=t.length;for(let i=0;i<o;){let c=Math.min(s-this.pos,o-i);if(c===s){let f=gt(t);for(;s<=o-i;i+=s)this.process(f,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){yt(this),De(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:s,isLE:o}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let u=i;u<s;u++)n[u]=0;zn(r,s-8,BigInt(this.length*8),o),this.process(r,0);let c=gt(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let a=f/4,l=this.get();if(a>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<a;u++)c.setUint32(4*u,l[u],o)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:s,finished:o,destroyed:i,pos:c}=this;return t.length=s,t.pos=c,t.finished=o,t.destroyed=i,s%n&&t.buffer.set(r),t}};var Wn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),it=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ct=new Uint32Array(64),Jt=class extends Nt{constructor(){super(64,32,8,!1),this.A=it[0]|0,this.B=it[1]|0,this.C=it[2]|0,this.D=it[3]|0,this.E=it[4]|0,this.F=it[5]|0,this.G=it[6]|0,this.H=it[7]|0}get(){let{A:t,B:n,C:r,D:s,E:o,F:i,G:c,H:f}=this;return[t,n,r,s,o,i,c,f]}set(t,n,r,s,o,i,c,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=i|0,this.G=c|0,this.H=f|0}process(t,n){for(let u=0;u<16;u++,n+=4)ct[u]=t.getUint32(n,!1);for(let u=16;u<64;u++){let h=ct[u-15],y=ct[u-2],p=$(h,7)^$(h,18)^h>>>3,d=$(y,17)^$(y,19)^y>>>10;ct[u]=d+ct[u-7]+p+ct[u-16]|0}let{A:r,B:s,C:o,D:i,E:c,F:f,G:a,H:l}=this;for(let u=0;u<64;u++){let h=$(c,6)^$(c,11)^$(c,25),y=l+h+We(c,f,a)+Wn[u]+ct[u]|0,d=($(r,2)^$(r,13)^$(r,22))+Fe(r,s,o)|0;l=a,a=f,f=c,c=i+y|0,i=o,o=s,s=r,r=y+d|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,i=i+this.D|0,c=c+this.E|0,f=f+this.F|0,a=a+this.G|0,l=l+this.H|0,this.set(r,s,o,i,c,f,a,l)}roundClean(){ct.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var z=je(()=>new Jt);var Ge=BigInt(0);function ee(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Xe(e){if(!ee(e))throw new Error("Uint8Array expected")}var Fn=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function $n(e){Xe(e);let t="";for(let n=0;n<e.length;n++)t+=Fn[e[n]];return t}function Gn(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Ge:BigInt("0x"+e)}var tt={_0:48,_9:57,A:65,F:70,a:97,f:102};function $e(e){if(e>=tt._0&&e<=tt._9)return e-tt._0;if(e>=tt.A&&e<=tt.F)return e-(tt.A-10);if(e>=tt.a&&e<=tt.f)return e-(tt.a-10)}function Ye(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let s=0,o=0;s<n;s++,o+=2){let i=$e(e.charCodeAt(o)),c=$e(e.charCodeAt(o+1));if(i===void 0||c===void 0){let f=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+o)}r[s]=i*16+c}return r}function ne(e){return Xe(e),Gn($n(Uint8Array.from(e).reverse()))}function Xn(e,t){return Ye(e.toString(16).padStart(t*2,"0"))}function Ze(e,t){return Xn(e,t).reverse()}function re(e,t,n){let r;if(typeof t=="string")try{r=Ye(t)}catch(o){throw new Error(e+" must be hex string or Uint8Array, cause: "+o)}else if(ee(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let s=r.length;if(typeof n=="number"&&s!==n)throw new Error(e+" of length "+n+" expected, got "+s);return r}var te=e=>typeof e=="bigint"&&Ge<=e;function Yn(e,t,n){return te(e)&&te(t)&&te(n)&&t<=e&&e<n}function oe(e,t,n,r){if(!Yn(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}var Zn={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||ee(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Qe(e,t,n={}){let r=(s,o,i)=>{let c=Zn[o];if(typeof c!="function")throw new Error("invalid validator function");let f=e[s];if(!(i&&f===void 0)&&!c(f,e))throw new Error("param "+String(s)+" is invalid. Expected "+o+", got "+f)};for(let[s,o]of Object.entries(t))r(s,o,!1);for(let[s,o]of Object.entries(n))r(s,o,!0);return e}var wt=BigInt(0),Rt=BigInt(1);function Mt(e,t){let n=e%t;return n>=wt?n:t+n}function Je(e,t,n){if(t<wt)throw new Error("invalid exponent, negatives unsupported");if(n<=wt)throw new Error("invalid modulus");if(n===Rt)return wt;let r=Rt;for(;t>wt;)t&Rt&&(r=r*e%n),e=e*e%n,t>>=Rt;return r}function F(e,t,n){let r=e;for(;t-- >wt;)r*=r,r%=n;return r}var bt=BigInt(0),se=BigInt(1);function Qn(e){return Qe(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze(Wt({},e))}function tn(e){let t=Qn(e),{P:n}=t,r=b=>Mt(b,n),s=t.montgomeryBits,o=Math.ceil(s/8),i=t.nByteLength,c=t.adjustScalarBytes||(b=>b),f=t.powPminus2||(b=>Je(b,n-BigInt(2),n));function a(b,E,C){let P=r(b*(E-C));return E=r(E-P),C=r(C+P),[E,C]}let l=(t.a-BigInt(2))/BigInt(4);function u(b,E){oe("u",b,bt,n),oe("scalar",E,bt,n);let C=E,P=b,L=se,N=bt,M=b,A=se,v=bt,B;for(let U=BigInt(s-1);U>=bt;U--){let T=C>>U&se;v^=T,B=a(v,L,M),L=B[0],M=B[1],B=a(v,N,A),N=B[0],A=B[1],v=T;let _=L+N,S=r(_*_),I=L-N,k=r(I*I),g=S-k,H=M+A,q=M-A,K=r(q*_),W=r(H*I),Y=K+W,Z=K-W;M=r(Y*Y),A=r(P*r(Z*Z)),L=r(S*k),N=r(g*(S+r(l*g)))}B=a(v,L,M),L=B[0],M=B[1],B=a(v,N,A),N=B[0],A=B[1];let O=f(N);return r(L*O)}function h(b){return Ze(r(b),o)}function y(b){let E=re("u coordinate",b,o);return i===32&&(E[31]&=127),ne(E)}function p(b){let E=re("scalar",b),C=E.length;if(C!==o&&C!==i){let P=""+o+" or "+i;throw new Error("invalid scalar, expected "+P+" bytes, got "+C)}return ne(c(E))}function d(b,E){let C=y(E),P=p(b),L=u(C,P);if(L===bt)throw new Error("invalid private or public key received");return h(L)}let w=h(t.Gu);function m(b){return d(b,w)}return{scalarMult:d,scalarMultBase:m,getSharedSecret:(b,E)=>d(b,E),getPublicKey:b=>m(b),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:w}}var ie=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");var po=BigInt(0),Jn=BigInt(1),en=BigInt(2),tr=BigInt(3),er=BigInt(5),yo=BigInt(8);function nr(e){let t=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),o=ie,c=e*e%o*e%o,f=F(c,en,o)*c%o,a=F(f,Jn,o)*e%o,l=F(a,er,o)*a%o,u=F(l,t,o)*l%o,h=F(u,n,o)*u%o,y=F(h,r,o)*h%o,p=F(y,s,o)*y%o,d=F(p,s,o)*y%o,w=F(d,t,o)*l%o;return{pow_p_5_8:F(w,en,o)*e%o,b2:c}}function rr(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}var Lt=tn({P:ie,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=ie,{pow_p_5_8:n,b2:r}=nr(e);return Mt(F(n,tr,t)*r,t)},adjustScalarBytes:rr,randomBytes:Q});var Ht=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(l){try{a(r.next(l))}catch(u){i(u)}}function f(l){try{a(r.throw(l))}catch(u){i(u)}}function a(l){l.done?o(l.value):s(l.value).then(c,f)}a((r=r.apply(e,t||[])).next())})},fe=!1,nn=!1;var rn=(()=>{let e;return()=>Ht(void 0,void 0,void 0,function*(){if(e===void 0)try{yield crypto.subtle.importKey("raw",Lt.GuBytes,{name:"X25519"},fe,[]),e=!0}catch(t){e=!1}return e})})();function qt(e,t){return Ht(this,void 0,void 0,function*(){if(!(yield rn())||nn){if(ce(e))throw new Error("CryptoKey provided but X25519 WebCrypto is not supported");return Lt.scalarMult(e,t)}let n;ce(e)?n=e:n=yield sr(e);let r=yield crypto.subtle.importKey("raw",t,{name:"X25519"},fe,[]);return new Uint8Array(yield crypto.subtle.deriveBits({name:"X25519",public:r},n,256))})}function mt(e){return Ht(this,void 0,void 0,function*(){if(!(yield rn())||nn){if(ce(e))throw new Error("CryptoKey provided but X25519 WebCrypto is not supported");return Lt.scalarMultBase(e)}return qt(e,Lt.GuBytes)})}var or=new Uint8Array([48,46,2,1,0,48,5,6,3,43,101,110,4,34,4,32]);function sr(e){return Ht(this,void 0,void 0,function*(){if(e.length!==32)throw new Error("X25519 private key must be 32 bytes");let t=new Uint8Array([...or,...e]);return crypto.subtle.importKey("pkcs8",t,{name:"X25519"},fe,["deriveBits"])})}function ce(e){return typeof CryptoKey!="undefined"&&e instanceof CryptoKey}function cr(e,t,n,r){at(e);let s=kt({dkLen:32,asyncTick:10},r),{c:o,dkLen:i,asyncTick:c}=s;if(j(o),j(i),j(c),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let f=G(t),a=G(n),l=new Uint8Array(i),u=J.create(e,f),h=u._cloneInto().update(a);return{c:o,dkLen:i,asyncTick:c,DK:l,PRF:u,PRFSalt:h}}function fr(e,t,n,r,s){return e.destroy(),t.destroy(),r&&r.destroy(),s.fill(0),n}function ae(e,t,n,r){let{c:s,dkLen:o,DK:i,PRF:c,PRFSalt:f}=cr(e,t,n,r),a,l=new Uint8Array(4),u=gt(l),h=new Uint8Array(c.outputLen);for(let y=1,p=0;p<o;y++,p+=c.outputLen){let d=i.subarray(p,p+c.outputLen);u.setInt32(0,y,!1),(a=f._cloneInto(a)).update(l).digestInto(h),d.set(h.subarray(0,d.length));for(let w=1;w<s;w++){c._cloneInto(a).update(h).digestInto(h);for(let m=0;m<d.length;m++)d[m]^=h[m]}}return fr(c,f,i,a,h)}function sn(e,t,n,r,s,o){let i=e[t++]^n[r++],c=e[t++]^n[r++],f=e[t++]^n[r++],a=e[t++]^n[r++],l=e[t++]^n[r++],u=e[t++]^n[r++],h=e[t++]^n[r++],y=e[t++]^n[r++],p=e[t++]^n[r++],d=e[t++]^n[r++],w=e[t++]^n[r++],m=e[t++]^n[r++],b=e[t++]^n[r++],E=e[t++]^n[r++],C=e[t++]^n[r++],P=e[t++]^n[r++],L=i,N=c,M=f,A=a,v=l,B=u,O=h,U=y,T=p,_=d,S=w,I=m,k=b,g=E,H=C,q=P;for(let K=0;K<8;K+=2)v^=R(L+k|0,7),T^=R(v+L|0,9),k^=R(T+v|0,13),L^=R(k+T|0,18),_^=R(B+N|0,7),g^=R(_+B|0,9),N^=R(g+_|0,13),B^=R(N+g|0,18),H^=R(S+O|0,7),M^=R(H+S|0,9),O^=R(M+H|0,13),S^=R(O+M|0,18),A^=R(q+I|0,7),U^=R(A+q|0,9),I^=R(U+A|0,13),q^=R(I+U|0,18),N^=R(L+A|0,7),M^=R(N+L|0,9),A^=R(M+N|0,13),L^=R(A+M|0,18),O^=R(B+v|0,7),U^=R(O+B|0,9),v^=R(U+O|0,13),B^=R(v+U|0,18),I^=R(S+_|0,7),T^=R(I+S|0,9),_^=R(T+I|0,13),S^=R(_+T|0,18),k^=R(q+H|0,7),g^=R(k+q|0,9),H^=R(g+k|0,13),q^=R(H+g|0,18);s[o++]=i+L|0,s[o++]=c+N|0,s[o++]=f+M|0,s[o++]=a+A|0,s[o++]=l+v|0,s[o++]=u+B|0,s[o++]=h+O|0,s[o++]=y+U|0,s[o++]=p+T|0,s[o++]=d+_|0,s[o++]=w+S|0,s[o++]=m+I|0,s[o++]=b+k|0,s[o++]=E+g|0,s[o++]=C+H|0,s[o++]=P+q|0}function ue(e,t,n,r,s){let o=r+0,i=r+16*s;for(let c=0;c<16;c++)n[i+c]=e[t+(2*s-1)*16+c];for(let c=0;c<s;c++,o+=16,t+=16)sn(n,i,e,t,n,o),c>0&&(i+=16),sn(n,o,e,t+=16,n,i)}function ar(e,t,n){let r=kt({dkLen:32,asyncTick:10,maxmem:1073742848},n),{N:s,r:o,p:i,dkLen:c,asyncTick:f,maxmem:a,onProgress:l}=r;if(j(s),j(o),j(i),j(c),j(f),j(a),l!==void 0&&typeof l!="function")throw new Error("progressCb should be function");let u=128*o,h=u/4;if(s<=1||s&s-1||s>rt(2,32))throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(i<0||i>(rt(2,32)-1)*32/u)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(c<0||c>(rt(2,32)-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(u*(s+i)>a)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+a);let p=ae(z,e,t,{c:1,dkLen:u*i}),d=Tt(p),w=Tt(new Uint8Array(u*s)),m=Tt(new Uint8Array(u)),b=()=>{};if(l){let E=2*s*i,C=Math.max(Math.floor(E/1e4),1),P=0;b=()=>{P++,l&&(!(P%C)||P===E)&&l(P/E)}}return{N:s,r:o,p:i,dkLen:c,blockSize32:h,V:w,B32:d,B:p,tmp:m,blockMixCb:b,asyncTick:f}}function ur(e,t,n,r,s){let o=ae(z,e,n,{c:1,dkLen:t});return n.fill(0),r.fill(0),s.fill(0),o}function le(e,t,n){let{N:r,r:s,p:o,dkLen:i,blockSize32:c,V:f,B32:a,B:l,tmp:u,blockMixCb:h}=ar(e,t,n);Yt||Zt(a);for(let y=0;y<o;y++){let p=c*y;for(let d=0;d<c;d++)f[d]=a[p+d];for(let d=0,w=0;d<r-1;d++)ue(f,w,f,w+=c,s),h();ue(f,(r-1)*c,a,p,s),h();for(let d=0;d<r;d++){let w=a[p+c-16]%r;for(let m=0;m<c;m++)u[m]=a[p+m]^f[w*c+m];ue(u,0,a,p,s),h()}}return Yt||Zt(a),ur(e,i,l,f,u)}function Kt(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function he(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function V(e,...t){if(!he(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function de(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function cn(e,t){V(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function pe(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}var et=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),fn=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),lr=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!lr)throw new Error("Non little-endian hardware is not supported");function hr(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Pt(e){if(typeof e=="string")e=hr(e);else if(he(e))e=Dt(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function an(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function un(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}var ye=(e,t)=>{function n(r,...s){if(V(r),e.nonceLength!==void 0){let l=s[0];if(!l)throw new Error("nonce / iv required");e.varSizeNonce?V(l):V(l,e.nonceLength)}let o=e.tagLength;o&&s[1]!==void 0&&V(s[1]);let i=t(r,...s),c=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");V(u)}},f=!1;return{encrypt(l,u){if(f)throw new Error("cannot encrypt() twice with same key + nonce");return f=!0,V(l),c(i.encrypt.length,u),i.encrypt(l,u)},decrypt(l,u){if(V(l),o&&l.length<o)throw new Error("invalid ciphertext length: smaller than tagLength="+o);return c(i.decrypt.length,u),i.decrypt(l,u)}}}return Object.assign(n,e),n};function xe(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!dr(t))throw new Error("invalid output, must be aligned");return t}function ge(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),c=Number(n&o),f=r?4:0,a=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+a,c,r)}function dr(e){return e.byteOffset%4===0}function Dt(e){return Uint8Array.from(e)}function nt(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}var hn=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),pr=hn("expand 16-byte k"),yr=hn("expand 32-byte k"),xr=et(pr),gr=et(yr);function x(e,t){return e<<t|e>>>32-t}function we(e){return e.byteOffset%4===0}var Vt=64,wr=16,dn=rt(2,32)-1,ln=new Uint32Array;function br(e,t,n,r,s,o,i,c){let f=s.length,a=new Uint8Array(Vt),l=et(a),u=we(s)&&we(o),h=u?et(s):ln,y=u?et(o):ln;for(let p=0;p<f;i++){if(e(t,n,r,l,i,c),i>=dn)throw new Error("arx: counter overflow");let d=Math.min(Vt,f-p);if(u&&d===Vt){let w=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let m=0,b;m<wr;m++)b=w+m,y[b]=h[b]^l[m];p+=Vt;continue}for(let w=0,m;w<d;w++)m=p+w,o[m]=s[m]^a[w];p+=d}}function be(e,t){let{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:o,rounds:i}=an({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return Kt(s),Kt(i),pe(o),pe(n),(c,f,a,l,u=0)=>{V(c),V(f),V(a);let h=a.length;if(l===void 0&&(l=new Uint8Array(h)),V(l),Kt(u),u<0||u>=dn)throw new Error("arx: counter overflow");if(l.length<h)throw new Error(`arx: output (${l.length}) is shorter than data (${h})`);let y=[],p=c.length,d,w;if(p===32)y.push(d=Dt(c)),w=gr;else if(p===16&&n)d=new Uint8Array(32),d.set(c),d.set(c,16),w=xr,y.push(d);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);we(f)||y.push(f=Dt(f));let m=et(d);if(r){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(w,m,et(f.subarray(0,16)),m),f=f.subarray(16)}let b=16-s;if(b!==f.length)throw new Error(`arx: nonce must be ${b} or 16 bytes`);if(b!==12){let C=new Uint8Array(12);C.set(f,o?0:12-f.length),f=C,y.push(f)}let E=et(f);return br(e,w,m,E,a,l,u,i),nt(...y),l}}var D=(e,t)=>e[t++]&255|(e[t++]&255)<<8,me=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=Pt(t),V(t,32);let n=D(t,0),r=D(t,2),s=D(t,4),o=D(t,6),i=D(t,8),c=D(t,10),f=D(t,12),a=D(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|o<<9)&8191,this.r[4]=(o>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|c<<2)&8191,this.r[7]=(c>>>11|f<<5)&8065,this.r[8]=(f>>>8|a<<8)&8191,this.r[9]=a>>>5&127;for(let l=0;l<8;l++)this.pad[l]=D(t,16+2*l)}process(t,n,r=!1){let s=r?0:2048,{h:o,r:i}=this,c=i[0],f=i[1],a=i[2],l=i[3],u=i[4],h=i[5],y=i[6],p=i[7],d=i[8],w=i[9],m=D(t,n+0),b=D(t,n+2),E=D(t,n+4),C=D(t,n+6),P=D(t,n+8),L=D(t,n+10),N=D(t,n+12),M=D(t,n+14),A=o[0]+(m&8191),v=o[1]+((m>>>13|b<<3)&8191),B=o[2]+((b>>>10|E<<6)&8191),O=o[3]+((E>>>7|C<<9)&8191),U=o[4]+((C>>>4|P<<12)&8191),T=o[5]+(P>>>1&8191),_=o[6]+((P>>>14|L<<2)&8191),S=o[7]+((L>>>11|N<<5)&8191),I=o[8]+((N>>>8|M<<8)&8191),k=o[9]+(M>>>5|s),g=0,H=g+A*c+v*(5*w)+B*(5*d)+O*(5*p)+U*(5*y);g=H>>>13,H&=8191,H+=T*(5*h)+_*(5*u)+S*(5*l)+I*(5*a)+k*(5*f),g+=H>>>13,H&=8191;let q=g+A*f+v*c+B*(5*w)+O*(5*d)+U*(5*p);g=q>>>13,q&=8191,q+=T*(5*y)+_*(5*h)+S*(5*u)+I*(5*l)+k*(5*a),g+=q>>>13,q&=8191;let K=g+A*a+v*f+B*c+O*(5*w)+U*(5*d);g=K>>>13,K&=8191,K+=T*(5*p)+_*(5*y)+S*(5*h)+I*(5*u)+k*(5*l),g+=K>>>13,K&=8191;let W=g+A*l+v*a+B*f+O*c+U*(5*w);g=W>>>13,W&=8191,W+=T*(5*d)+_*(5*p)+S*(5*y)+I*(5*h)+k*(5*u),g+=W>>>13,W&=8191;let Y=g+A*u+v*l+B*a+O*f+U*c;g=Y>>>13,Y&=8191,Y+=T*(5*w)+_*(5*d)+S*(5*p)+I*(5*y)+k*(5*h),g+=Y>>>13,Y&=8191;let Z=g+A*h+v*u+B*l+O*a+U*f;g=Z>>>13,Z&=8191,Z+=T*c+_*(5*w)+S*(5*d)+I*(5*p)+k*(5*y),g+=Z>>>13,Z&=8191;let lt=g+A*y+v*h+B*u+O*l+U*a;g=lt>>>13,lt&=8191,lt+=T*f+_*c+S*(5*w)+I*(5*d)+k*(5*p),g+=lt>>>13,lt&=8191;let ht=g+A*p+v*y+B*h+O*u+U*l;g=ht>>>13,ht&=8191,ht+=T*a+_*f+S*c+I*(5*w)+k*(5*d),g+=ht>>>13,ht&=8191;let dt=g+A*d+v*p+B*y+O*h+U*u;g=dt>>>13,dt&=8191,dt+=T*l+_*a+S*f+I*c+k*(5*w),g+=dt>>>13,dt&=8191;let pt=g+A*w+v*d+B*p+O*y+U*h;g=pt>>>13,pt&=8191,pt+=T*u+_*l+S*a+I*f+k*c,g+=pt>>>13,pt&=8191,g=(g<<2)+g|0,g=g+H|0,H=g&8191,g=g>>>13,q+=g,o[0]=H,o[1]=q,o[2]=K,o[3]=W,o[4]=Y,o[5]=Z,o[6]=lt,o[7]=ht,o[8]=dt,o[9]=pt}finalize(){let{h:t,pad:n}=this,r=new Uint16Array(10),s=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=s,s=t[c]>>>13,t[c]&=8191;t[0]+=s*5,s=t[0]>>>13,t[0]&=8191,t[1]+=s,s=t[1]>>>13,t[1]&=8191,t[2]+=s,r[0]=t[0]+5,s=r[0]>>>13,r[0]&=8191;for(let c=1;c<10;c++)r[c]=t[c]+s,s=r[c]>>>13,r[c]&=8191;r[9]-=8192;let o=(s^1)-1;for(let c=0;c<10;c++)r[c]&=o;o=~o;for(let c=0;c<10;c++)t[c]=t[c]&o|r[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let i=t[0]+n[0];t[0]=i&65535;for(let c=1;c<8;c++)i=(t[c]+n[c]|0)+(i>>>16)|0,t[c]=i&65535;nt(r)}update(t){de(this);let{buffer:n,blockLen:r}=this;t=Pt(t);let s=t.length;for(let o=0;o<s;){let i=Math.min(r-this.pos,s-o);if(i===r){for(;r<=s-o;o+=r)this.process(t,o);continue}n.set(t.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){nt(this.h,this.r,this.buffer,this.pad)}digestInto(t){de(this),cn(t,this),this.finished=!0;let{buffer:n,h:r}=this,{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let o=0;for(let i=0;i<8;i++)t[o++]=r[i]>>>0,t[o++]=r[i]>>>8;return t}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}};function mr(e){let t=(r,s)=>e(s).update(Pt(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}var pn=mr(e=>new me(e));function gn(e,t,n,r,s,o=20){let i=e[0],c=e[1],f=e[2],a=e[3],l=t[0],u=t[1],h=t[2],y=t[3],p=t[4],d=t[5],w=t[6],m=t[7],b=s,E=n[0],C=n[1],P=n[2],L=i,N=c,M=f,A=a,v=l,B=u,O=h,U=y,T=p,_=d,S=w,I=m,k=b,g=E,H=C,q=P;for(let W=0;W<o;W+=2)L=L+v|0,k=x(k^L,16),T=T+k|0,v=x(v^T,12),L=L+v|0,k=x(k^L,8),T=T+k|0,v=x(v^T,7),N=N+B|0,g=x(g^N,16),_=_+g|0,B=x(B^_,12),N=N+B|0,g=x(g^N,8),_=_+g|0,B=x(B^_,7),M=M+O|0,H=x(H^M,16),S=S+H|0,O=x(O^S,12),M=M+O|0,H=x(H^M,8),S=S+H|0,O=x(O^S,7),A=A+U|0,q=x(q^A,16),I=I+q|0,U=x(U^I,12),A=A+U|0,q=x(q^A,8),I=I+q|0,U=x(U^I,7),L=L+B|0,q=x(q^L,16),S=S+q|0,B=x(B^S,12),L=L+B|0,q=x(q^L,8),S=S+q|0,B=x(B^S,7),N=N+O|0,k=x(k^N,16),I=I+k|0,O=x(O^I,12),N=N+O|0,k=x(k^N,8),I=I+k|0,O=x(O^I,7),M=M+U|0,g=x(g^M,16),T=T+g|0,U=x(U^T,12),M=M+U|0,g=x(g^M,8),T=T+g|0,U=x(U^T,7),A=A+v|0,H=x(H^A,16),_=_+H|0,v=x(v^_,12),A=A+v|0,H=x(H^A,8),_=_+H|0,v=x(v^_,7);let K=0;r[K++]=i+L|0,r[K++]=c+N|0,r[K++]=f+M|0,r[K++]=a+A|0,r[K++]=l+v|0,r[K++]=u+B|0,r[K++]=h+O|0,r[K++]=y+U|0,r[K++]=p+T|0,r[K++]=d+_|0,r[K++]=w+S|0,r[K++]=m+I|0,r[K++]=b+k|0,r[K++]=E+g|0,r[K++]=C+H|0,r[K++]=P+q|0}function Er(e,t,n,r){let s=e[0],o=e[1],i=e[2],c=e[3],f=t[0],a=t[1],l=t[2],u=t[3],h=t[4],y=t[5],p=t[6],d=t[7],w=n[0],m=n[1],b=n[2],E=n[3];for(let P=0;P<20;P+=2)s=s+f|0,w=x(w^s,16),h=h+w|0,f=x(f^h,12),s=s+f|0,w=x(w^s,8),h=h+w|0,f=x(f^h,7),o=o+a|0,m=x(m^o,16),y=y+m|0,a=x(a^y,12),o=o+a|0,m=x(m^o,8),y=y+m|0,a=x(a^y,7),i=i+l|0,b=x(b^i,16),p=p+b|0,l=x(l^p,12),i=i+l|0,b=x(b^i,8),p=p+b|0,l=x(l^p,7),c=c+u|0,E=x(E^c,16),d=d+E|0,u=x(u^d,12),c=c+u|0,E=x(E^c,8),d=d+E|0,u=x(u^d,7),s=s+a|0,E=x(E^s,16),p=p+E|0,a=x(a^p,12),s=s+a|0,E=x(E^s,8),p=p+E|0,a=x(a^p,7),o=o+l|0,w=x(w^o,16),d=d+w|0,l=x(l^d,12),o=o+l|0,w=x(w^o,8),d=d+w|0,l=x(l^d,7),i=i+u|0,m=x(m^i,16),h=h+m|0,u=x(u^h,12),i=i+u|0,m=x(m^i,8),h=h+m|0,u=x(u^h,7),c=c+f|0,b=x(b^c,16),y=y+b|0,f=x(f^y,12),c=c+f|0,b=x(b^c,8),y=y+b|0,f=x(f^y,7);let C=0;r[C++]=s,r[C++]=o,r[C++]=i,r[C++]=c,r[C++]=w,r[C++]=m,r[C++]=b,r[C++]=E}var Br=be(gn,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Ar=be(gn,{counterRight:!1,counterLength:8,extendNonceFn:Er,allowShortKeys:!1});var vr=new Uint8Array(16),yn=(e,t)=>{e.update(t);let n=t.length%16;n&&e.update(vr.subarray(n))},Lr=new Uint8Array(32);function xn(e,t,n,r,s){let o=e(t,n,Lr),i=pn.create(o);s&&yn(i,s),yn(i,r);let c=new Uint8Array(16),f=fn(c);ge(f,0,BigInt(s?s.length:0),!0),ge(f,8,BigInt(r.length),!0),i.update(c);let a=i.digest();return nt(o,c),a}var wn=e=>(t,n,r)=>({encrypt(o,i){let c=o.length;i=xe(c+16,i,!1),i.set(o);let f=i.subarray(0,-16);e(t,n,f,f,1);let a=xn(e,t,n,f,r);return i.set(a,c),nt(a),i},decrypt(o,i){i=xe(o.length-16,i,!1);let c=o.subarray(0,-16),f=o.subarray(-16),a=xn(e,t,n,c,r);if(!un(f,a))throw new Error("invalid tag");return i.set(o.subarray(0,-16)),e(t,n,i,i,1),nt(a),i}}),ft=ye({blockSize:64,nonceLength:12,tagLength:16},wn(Br)),zo=ye({blockSize:64,nonceLength:24,tagLength:16},wn(Ar));var Et=class{constructor(t,n){this.args=t,this.body=n}},Ut=class{constructor(t){this.arr=t}toString(t){return t.forEach(n=>{if(n<32||n>136)throw Error("invalid non-ASCII byte in header")}),new TextDecoder().decode(t)}readString(t){let n=this.arr.subarray(0,t);return this.arr=this.arr.subarray(t),this.toString(n)}readLine(){let t=this.arr.indexOf(10);if(t>=0){let n=this.arr.subarray(0,t);return this.arr=this.arr.subarray(t+1),this.toString(n)}return null}rest(){return this.arr}};function Ur(e){let t=new Ut(e);if(t.readString(3)!=="-> ")throw Error("invalid stanza");let n=t.readLine();if(n===null)throw Error("invalid stanza");let r=n.split(" ");if(r.length<1)throw Error("invalid stanza");for(let i of r)if(i.length===0)throw Error("invalid stanza");let s=[];for(;;){let i=t.readLine();if(i===null)throw Error("invalid stanza");let c=X.decode(i);if(c.length>48)throw Error("invalid stanza");if(s.push(c),c.length<48)break}let o=bn(s);return[new Et(r,o),t.rest()]}function bn(e){let t=e.reduce((s,o)=>s+o.length,0),n=new Uint8Array(t),r=0;for(let s of e)n.set(s,r),r+=s.length;return n}function mn(e){let t=new Ut(e),n=t.readLine();if(n!=="age-encryption.org/v1")throw Error("invalid version "+(n!=null?n:"line"));let r=t.rest(),s=[];for(;;){let o;[o,r]=Ur(r),s.push(o);let i=new Ut(r);if(i.readString(4)==="--- "){let c=e.subarray(0,e.length-i.rest().length-1),f=i.readLine();if(f===null)throw Error("invalid header");let a=X.decode(f);return{recipients:s,headerNoMAC:c,MAC:a,rest:i.rest()}}}}function Ee(e){let t=[];t.push(`age-encryption.org/v1
`);for(let n of e){t.push("-> "+n.args.join(" ")+`
`);for(let r=0;r<n.body.length;r+=48){let s=r+48;s>n.body.length&&(s=n.body.length),t.push(X.encode(n.body.subarray(r,s))+`
`)}n.body.length%48===0&&t.push(`
`)}return t.push("---"),new TextEncoder().encode(t.join(""))}function En(e,t){return bn([Ee(e),new TextEncoder().encode(" "+X.encode(t)+`
`)])}var Bn=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(l){try{a(r.next(l))}catch(u){i(u)}}function f(l){try{a(r.throw(l))}catch(u){i(u)}}function a(l){l.done?o(l.value):s(l.value).then(c,f)}a((r=r.apply(e,t||[])).next())})};function An(e,t){return Bn(this,void 0,void 0,function*(){let n=Q(32),r=yield mt(n),s=yield qt(n,t),o=new Uint8Array(r.length+t.length);o.set(r),o.set(t,r.length);let i=st(z,s,o,"age-encryption.org/v1/X25519",32);return new Et(["X25519",X.encode(r)],_n(e,i))})}function vn(e,t){return Bn(this,void 0,void 0,function*(){if(e.args.length<1||e.args[0]!=="X25519")return null;if(e.args.length!==2)throw Error("invalid X25519 stanza");let n=X.decode(e.args[1]);if(n.length!==32)throw Error("invalid X25519 stanza");let r=yield qt(t.identity,n),s=yield t.recipient,o=new Uint8Array(n.length+s.length);o.set(n),o.set(s,n.length);let i=st(z,r,o,"age-encryption.org/v1/X25519",32);return Sn(e.body,i)})}function Ln(e,t,n){let r=Q(16),s="age-encryption.org/v1/scrypt",o=new Uint8Array(s.length+16);o.set(new TextEncoder().encode(s)),o.set(r,s.length);let i=le(t,o,{N:Math.pow(2,n),r:8,p:1,dkLen:32});return new Et(["scrypt",X.encode(r),n.toString()],_n(e,i))}function Un(e,t){if(e.args.length<1||e.args[0]!=="scrypt")return null;if(e.args.length!==3||!/^[1-9][0-9]*$/.test(e.args[2]))throw Error("invalid scrypt stanza");let n=X.decode(e.args[1]);if(n.length!==16)throw Error("invalid scrypt stanza");let r=Number(e.args[2]);if(r>20)throw Error("scrypt work factor is too high");let s="age-encryption.org/v1/scrypt",o=new Uint8Array(s.length+16);o.set(new TextEncoder().encode(s)),o.set(n,s.length);let i=le(t,o,{N:Math.pow(2,r),r:8,p:1,dkLen:32});return Sn(e.body,i)}function _n(e,t){let n=new Uint8Array(12);return ft(t,n).encrypt(e)}function Sn(e,t){if(e.length!==32)throw Error("invalid stanza");let n=new Uint8Array(12);try{return ft(t,n).decrypt(e)}catch(r){return null}}var Be=16,_t=64*1024,jt=_t+Be;function In(e,t){let n=new Uint8Array(12),r=()=>{for(let a=n.length-2;a>=0&&(n[a]++,n[a]===0);a--);},o=Math.ceil(t.length/jt)*Be,i=new Uint8Array(t.length-o),c=i;for(;t.length>jt;){let a=ft(e,n).decrypt(t.subarray(0,jt));c.set(a),c=c.subarray(a.length),t=t.subarray(jt),r()}n[11]=1;let f=ft(e,n).decrypt(t);if(c.set(f),f.length===0&&i.length!==0)throw Error("empty final chunk");if(c.length!==f.length)throw Error("stream: internal error: didn't fill expected plaintext buffer");return i}function Cn(e,t){let n=new Uint8Array(12),r=()=>{for(let a=n.length-2;a>=0&&(n[a]++,n[a]===0);a--);},o=(t.length===0?1:Math.ceil(t.length/_t))*Be,i=new Uint8Array(t.length+o),c=i;for(;t.length>_t;){let a=ft(e,n).encrypt(t.subarray(0,_t));c.set(a),c=c.subarray(a.length),t=t.subarray(_t),r()}n[11]=1;let f=ft(e,n).encrypt(t);if(c.set(f),c.length!==f.length)throw Error("stream: internal error: didn't fill expected ciphertext buffer");return i}var zt=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(l){try{a(r.next(l))}catch(u){i(u)}}function f(l){try{a(r.throw(l))}catch(u){i(u)}}function a(l){l.done?o(l.value):s(l.value).then(c,f)}a((r=r.apply(e,t||[])).next())})};function _r(){let e=Q(32),t=ot.encode("AGE-SECRET-KEY-",ot.toWords(e)).toUpperCase();return Promise.resolve(t)}function Sr(e){return zt(this,void 0,void 0,function*(){let t;if(Tn(e))t=e;else{let r=ot.decodeToBytes(e);if(!e.startsWith("AGE-SECRET-KEY-1")||r.prefix.toUpperCase()!=="AGE-SECRET-KEY-"||r.bytes.length!==32)throw Error("invalid identity");t=r.bytes}let n=yield mt(t);return ot.encode("age",ot.toWords(n))})}var Ae=class{constructor(){this.passphrase=null,this.scryptWorkFactor=18,this.recipients=[]}setPassphrase(t){if(this.passphrase!==null)throw new Error("can encrypt to at most one passphrase");if(this.recipients.length!==0)throw new Error("can't encrypt to both recipients and passphrases");this.passphrase=t}setScryptWorkFactor(t){this.scryptWorkFactor=t}addRecipient(t){if(this.passphrase!==null)throw new Error("can't encrypt to both recipients and passphrases");let n=ot.decodeToBytes(t);if(!t.startsWith("age1")||n.prefix.toLowerCase()!=="age"||n.bytes.length!==32)throw Error("invalid recipient");this.recipients.push(n.bytes)}encrypt(t){return zt(this,void 0,void 0,function*(){typeof t=="string"&&(t=new TextEncoder().encode(t));let n=Q(16),r=[];for(let u of this.recipients)r.push(yield An(n,u));this.passphrase!==null&&r.push(Ln(n,this.passphrase,this.scryptWorkFactor));let s=st(z,n,void 0,"header",32),o=J(z,s,Ee(r)),i=En(r,o),c=Q(16),f=st(z,n,c,"payload",32),a=Cn(f,t),l=new Uint8Array(i.length+c.length+a.length);return l.set(i),l.set(c,i.length),l.set(a,i.length+c.length),l})}},ve=class{constructor(){this.passphrases=[],this.identities=[]}addPassphrase(t){this.passphrases.push(t)}addIdentity(t){if(Tn(t)){this.identities.push({identity:t,recipient:mt(t)});return}let n=ot.decodeToBytes(t);if(!t.startsWith("AGE-SECRET-KEY-1")||n.prefix.toUpperCase()!=="AGE-SECRET-KEY-"||n.bytes.length!==32)throw Error("invalid identity");this.identities.push({identity:n.bytes,recipient:mt(n.bytes)})}decrypt(t,n){return zt(this,void 0,void 0,function*(){let r=mn(t),s=yield this.unwrapFileKey(r.recipients);if(s===null)throw Error("no identity matched any of the file's recipients");let o=st(z,s,void 0,"header",32),i=J(z,o,r.headerNoMAC);if(!Ir(r.MAC,i))throw Error("invalid header HMAC");let c=r.rest.subarray(0,16),f=st(z,s,c,"payload",32),a=r.rest.subarray(16),l=In(f,a);return n==="text"?new TextDecoder().decode(l):l})}unwrapFileKey(t){return zt(this,void 0,void 0,function*(){for(let n of t){if(n.args.length>0&&n.args[0]==="scrypt"&&t.length!==1)throw Error("scrypt recipient is not the only one in the header");for(let r of this.passphrases){let s=Un(n,r);if(s!==null)return s}for(let r of this.identities){let s=yield vn(n,r);if(s!==null)return s}}return null})}};function Ir(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function Tn(e){return typeof CryptoKey!="undefined"&&e instanceof CryptoKey}return Hn(Cr);})();
/*! Bundled license information:

@scure/base/lib/esm/index.js:
  (*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
